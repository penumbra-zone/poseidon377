# M = 128
N = 1270
t = 5
n = int(N / t)
R_F = 8
R_P = 56
prime = 0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001
F = GF(prime)

round_constants = ['0x02e10a9dae33ce517d0de9a8ff8cb0ed1222414b29ec085b84bbb8fb01a09f42', '0x2c8806ce975e785d66aad47a77fc7dd0ad2e07a5c92fdd3e6315b32cf6aca12b', '0x0416576e7ecad611c084c5e743b87ef638010cf6cf0906943703f5f62b8261eb', '0x0bda64820bf5ca3487c5dd580ee5badbc1fd333b48ff329698babc80fb2dd879', '0x09e3b2963552cec17551c9d646fb0ffebe00cf10e58a07d9f28028b4773484b3', '0x0a05f6c0934e01f8c504067bdacbf2b0ccdfda848f689e9e86f9b30577d87c0e', '0x28d747e28d1561225e5944f125a57019ed06408038063b5d3038634696c9d598', '0x1e6a4864d67752d5dd7cc01f3dd62c193adda8ce4f163d378f15a9b3a53394dc', '0x22f21e4a3c14a27b63729c0c26a054c68256f60baffa8f52e0bc5b128b06808c', '0x0a89d368bcedda3735a41d8e57e3b3d14dcae9b3c84fee92144e03f6e0963fa6', '0x2de36331257fcb22bf954e0fc2ac7f3a04d10c5a8d15ff64991bac50b5ce2e48', '0x0f52d0444773f7b44e54bb95d7f417c632a0b9dbbb44ef44cb709fb94f246469', '0x1c759aa2baf71642a2d1fb6eae75eb8adcc62b7705eaf8de3dff8bdb571c66d5', '0x2a0db23ee930d560e3929f98ad16b2178c371f0a5fd14522ed1a3ac1a62973fe', '0x26f7572c286f2b940fb9e454ec381c2fc91aa0fef97e5433add6ef8be3f3a3b4', '0x1a4dc7a465537664fba805155b68388cc282d23d7b101953ad3034c4674e7214', '0x248c56d0386cd63d5777083b8fc6c3dc5143211ae36db74ec0f16c4395bd4438', '0x268613339fc7dface00ee36a98408b4d740cf992012b2d7c831047f3fcca3e38', '0x135b55fb5bbdad63807f614612f01d30cc89107510613cfe70e2070cf6a10c97', '0x1cbe8463c34cc541e7104e46c179e2b982152e82154c75dd17ede5a23781cfd4', '0x02b0729b14780069573a3e61ba045f313c7ee3b5163f2af717e3a7cf8143532d', '0x1c87a93d4fed15da4385871c3dc98b866a4c9ac73bf1c87b9183b9d945b0265b', '0x1bc5955891d84d167e6ed24cd08e532723fa6b337e57d09a2d172ffdcc8dbab6', '0x0f526dabfc15e66a89a335b959f4d2ee1a56b0c9b0297270e3e8db20178dffa0', '0x2cf9d8149603386abcef6aea74519f077f715c45a861154fdad57b890c327a86', '0x2f0a297a1c77c276fea8046a1eedceabc613de385d5b017cc48749b71bb6fa12', '0x165319a4a0e43a3fbeadbe8ffb77771da1c7699daf6d32379efd5112652aff2b', '0x2e2c6f181ac6964191382cbc3cd449e313d11fc78f0c1b9bc3a8059ce7ff7725', '0x1d9ea5a9daa484d2b65c31374ea7d218c75eabf1faceaeb4a3bf754bba084d9b', '0x292889e5a3e3154c943a368ae029fd50e8d0b9a220cb66e97f0c2097d1d82d20', '0x1f29d114930f61b28c88e08bfdf4b64469564c963d6a651d06d8d2570f7975c4', '0x02303c87f78470ad923c826158131cbb8130b3984d40ed7ae3cf7215ed436996', '0x265677a87b0f058a1f623bc4686524ef1c46be1629c4775816c80f6491138165', '0x301936731c0d38c2c70ccfb3f26de6f240e68d721346bbc08a41d5878dca5285', '0x21e201939e0deb768efc4e4484059af10e76a714bd8e0fd6f42dab6679b34426', '0x1833d2a08b177fc59d99ceac888ce85d4498b2722a678b43ab9120c96c281217', '0x2c1d420c90ae1aa695f7eec1f8edb4b104e1e625d2cbd3e726e54c239baf8e6b', '0x1cc7b7c49eb27aa67d4e3f5eacfc762ea1355238f7968ea117e0777e6265f981', '0x0ad88c30bb951c374f92ea63ed8765eb6696023cc4deeca1247d0951ccf11ac3', '0x184e8f334aa29c17c05fa7a31d48372372a982c77fa229d0ddbbe875a9fc58d0', '0x0a143c9075aabd682ad9fb73c778da0a354ac97dbcc1edd2ff98e683c47ef34a', '0x192e2da46a97556dd5359acea926cf88cc353dc0f0d5a84001137d3ebb713392', '0x28bd8e3a597f1ba7218e785d5f17bb784d208e999810825d67fd6f47801dcb18', '0x0a7f10986a598bd00bde9df6f32b0299e2b911746b72cd771c32a142a354b2d1', '0x0c23b4c96feb0c85bcc0bb73ea9338d78e6bb257337a30729b623a228047ff55', '0x0530924f2a313055bad6a06750ea198a1cb86855e9d0d5fe805ef758bb4aaba8', '0x247c0cfdbc76b205d969c84bb1ef3f46052266a4be9ceddd655365bead7ee45f', '0x2061b5f2d90ee19f45adc7d3fc3f6d2d0ae5240308977b6dacabe3b8297c0f04', '0x1cd535afab5d9703d11ccbf97a3cc6515ac61a1c791196a37502d8f1b5947003', '0x07e1d109091021b2f6ee5f027fa5b3e67e43617ae34cf009ee1fe9d7da488913', '0x27abbc77d5527c46fe21f348cd6a54e1328ed2cc25c59f81a04b8ea8d3e98a2a', '0x1313fd60a7ae469ef02faff8dc505476ce51570fabf0fda4b40698d24a15fb68', '0x10bdee8374d60fc33e93c9cade6d638206df464e20322b2f92ade5af1b271247', '0x002f21bf484864ee89224a2028631a9ee438b3594deb74e4e4e6afb12912ea9c', '0x28b908691dd4b6b88bf768b97c82f469301b58abd2dc282d50a1aa5fdb7ae37f', '0x254e9999e122b2817cd300613eb8806c32f5e91d1a3238349d376c74de50e159', '0x1357d98f1b2d4f01eba0b28776ff3663ea86ba35e659373a330858c7555ba6af', '0x2c6d6e65edf963cf1467d6fb7f68d8383ba30d35716313143bf128430ea3c185', '0x2f868851d51d75e2d6d996844f6ae02e55bf73e58c36f27e7068826c7f149811', '0x102762a923b271685de7a589c993b46ca4203f1f2c5c15399383ed3f7744b804', '0x24a50d89c8a741f2059eec338af1a7f7e5ab31686e22eafb1a79e0aeb7182c68', '0x278f8ee9027b27309074d81c09339cf60d06c1e260ea7e458e0eee5d17a7fe59', '0x122b0f3f72148ae73e1d0d99cf50c90e8f414e61026b60b2f76927ad721df431', '0x19f2c4f0fdc9bef7896fe15d8a8c163ac4141071921d134a388307e693f26c2d', '0x1043f9de261e8aea0b1e1c7073931ed903786e8fe7e2cebce1d2395879b8d066', '0x12039498a74ce19a0c2b1a7f0cc937cf93a234768c1335b512a51f2b3c7bad35', '0x12f717db2bb659b6b1fda2a723a2f84d04902d10ce6b2cf7f2e65429ffc48e09', '0x01f112edee80fa3f5eee1d2ea6226d8785ddbef1653dfc858d8db22aeb0b80f4', '0x2df1b351b50b95bed3bf56e93ad024cce1f0dc737fa2a4a26afcc93bc012d6d4', '0x2ded44beb4917ccf06ab499aabb2c043aca021dd0f33d4794b9aa04e8535a0ee', '0x13aace50e22d83d23425e5551703a33d47f035275c3c9a2a3e48c048575232d6', '0x1eda2287bde3f5e605dfcc6a7845588a4f79d6fee4573a501b114cb9994e0377', '0x0e0d1c8e46db7f89e34ea0fcd222a4edc104185cb51a8773ae0f9b669720066f', '0x09f2e65c1ad396c1c57e00b1979794080e8de4404bb7f3a32bb5f1ee0038f297', '0x234d43dbb3c70d10460a998aa16909ac52abcc0216fa4098b77235a4651e2f12', '0x0f93df330673115bae8e6d4090eb33a4d766667e88d8294749e0f9330111e55a', '0x061963bc5fe654f5db11538cab9f46b840ff06fedf1932ceb970db8f0292e9fa', '0x2ae28effef79f35c9dcd907be0e38b5c06a8e8b8fd773553b7b2437059dee94d', '0x171504e8b8c236e13b1094d82cd6ac57d15ac78ff6907f7d8ef4cadd1af9b044', '0x2df974b57689032ee1c33eee380c56289b8ddde4e774d92b8d747057b143b9d9', '0x0191888319bf05cf24e50430ce84d44c3ddedae7b4fd26ef0cdd28eb1d88fec5', '0x26fa3f65090a8cee07edd1566914c62300738db5f5aedbbc03bf2b8397afdc76', '0x1a736c58ddf045b402e3a4c86e0ddc4dffe6289deb6ea17a0e9b356d49ca5bdc', '0x2c27e0a47530bf6896f928673bd8eab9c0c35060e3852e729efa942b54ef3ad6', '0x2e1573529641adb391e5cc5e29db3a805b92be4e8ee281e742a31fec9051cda2', '0x20e4acfc1b3f616cc0baac40e3666bed45a6e5a0b429cfdb1569b159c93d5b93', '0x25ba84b80f6599683ecf8c06e9c300bc4720b2bd8763a768794003bc0f27737f', '0x0301d6823d8a6c6e708d6a785a3a0307a22647f6f8803e387670c785cdb49d32', '0x1aa3ed6d340013e0e190a01e5a29e8c682f6f226d7866f7987b64cb5f47b10c2', '0x22bb7515c9994d5193395910c70a3639d6e1572608feecb64506a53210bc5d56', '0x1be76fd3977b3b7b80d17093f475ab66e1f841d849c74a10458468491e61eb9a', '0x28670eb43245587ca0ebc2a0eeafe653f898e89a3ff0cd7da234ca5bb8cfb7ca', '0x302b818038e7616353df76e4cc40b9a3b14ecc4e9444c4fd6c55e850736b4b08', '0x0c3397ced58a0b845be07e487c00bcf7bc9dfc38c1021cccf2828b82d2d147b2', '0x301cd3a3208c7a632ceeca57d6c171723986585a01aed1bc59f3daa3a1b8a98d', '0x2758abd997b34a9dfc89fdd2bbef4d4e98c46138496a1279cf9b653f142e689d', '0x05daa364c3fb75dcd016c7b87aedb30ce375e1a483d494ad88772459d694267c', '0x2b5f5561f3a4f6d23b361c1ee16c2aae292e4e95a18235ea5d89bd9d8fd97607', '0x2490e9ea9db78dfa504c12a6588cf6a923cb8d5339db186f06034cc58dc8cf38', '0x0a443024fa6d1474253ac0ecd8ae0bb50dbea8b2630947f7b1d62500e6b51a4c', '0x09006eea2c6f5e653c2cb72ac47fdb065aa27a052b458d767cd891f2843a66f1', '0x12a806854b356c1b3e07b2e973aa8bdda98883fe53686f174b90a338728e0a43', '0x0cb7e244df10649bec737cf3a007ff48e3af2b60d674c4cc6e2c75ebdda916cb', '0x0ad29371102f5a2251df3279d8256d30c45f43a33b12b0c480c778c26f4ff883', '0x0038879e88c5deed0ae53fc9ed6404318276960080ec1d62fbdba2eb3a3e0f02', '0x0440c937af4f13b1bdcc6f9ffb1dd5b4fbaba3d4e67b1afaf51b6512aa8ba1be', '0x2d46189bb48fd04379377801ec5a9155f8abbcb14fc189095505763d44155289', '0x08dbcbe09940588a955b7f1e570784f2baa0d0638ff5d6c78e83d2389b45de96', '0x1658e98658f041ff99ca9faa1dc13801cb8e841a55fc33468ba2e76830164bb7', '0x0fbd88e63cd51cb068bfaa0e98ae36d5e2db5b4f48678e277098f422d1da4b72', '0x15d3933053b226951098dc60c42dcad40417705a2e9013b47cb35ce6b187b9ea', '0x2fc514c113981d677e171a0f7ec04eb7ff6b62b0da2718d2a406930ca68fef4c', '0x27cc4d5b7218ef0efcd5ef5ed9d65998647bc0c9310da385fd38c3a3c3616045', '0x2e4a0dd343df2c80dfd17616cc4dc73781e64f78285f7bea27c0a817a3123e65', '0x1ea0d82a27ff59183d69280f2e02bdc8dac3ac475a8374707716a3254281e774', '0x0fa1d15e68cf387601ed0eee362ac8e1823b79bef8dbeaf874c11db87976a4b3', '0x18ba21930d1458523267510c56c3111000f4f75db8540262a1239874c05b4140', '0x1c6404ba9e78fe1f337a94cae179e6e01e17d3342a421bfa712dd09aeb351c08', '0x03e163c6e29e5256257b4cecd8bc1cd456bbc9b10834b955bf65c9e8f9a04aeb', '0x2597fa9d267b169811a26b6dc0e66fff2659a05ba3d8e568e3e6699e44ab129c', '0x1ec57f93b50ccd9c5a68b15dc56d628a7db1207c91231e360fe83d8abe264a2b', '0x189265c0e07d26304f0b7f6adaa4e46606a38bc7a1963ac8ad72ecfcf48a60a9', '0x28c495e5c0ba9b43cd22ac53422dda99396498bee63643b7b6e1f21d4c96d650', '0x17480418f4ba926437eba8d7b5d7a7092c809aaf28eefffd1a8b593c0926d869', '0x2e9664daba73b028b4cefd5e5097a608ae0a0e262f047fd93015bba53f3c412d', '0x04a165060875e668f89d71e782cf480de7301c8c73e332927af9247574f08ed9', '0x13b63568139ed8499ad0dd8dd5ab1c7b90aa857885a30c776f34a98798aef236', '0x10d6b27bd08a3bb5e51a70fdae8f5b503f7e9e6476933e59f61ed85839c33932', '0x12216ffbb041cab53124b86d7e3627e6e2b1f0a933a759a59e4bc9327face3a4', '0x2ddd35fec0b91e4ebbd9aa91f2e0307be369d360b60b38ab21012f72f8827df5', '0x2f45f49c5656c085fa835cdc163896b0e4f82b18a3f859988c4bb702bc0d9819', '0x0bdb9b80b6241b94918f06ba3aa82a419dc5ac31d3867fda3c5110cf61f269db', '0x2a9b36fc58912f83c67a1a420b8cb742370882637eb510d60580ec2237d76d38', '0x2aa2d7df1586fe23f77c795a51f2a059971cb3ff141b661b764882c010e3ba74', '0x099c5821008b2bfae01417907e0226c9f62747c8b09c4ebe80d376123fe86fa5', '0x0bd29f71e07c2ebdcd89c6c3b25db08a72afea74109dbf3061b0e0da9adb716c', '0x2180de72ca187ce893c5bb37b5fe3d2e641e56c08b66bfd4ef2ef78be1c9eff6', '0x1f94b05c7e76c82e84a021d083ac47ea0e0e6a09bc6c2b78f9545f552079ab32', '0x1578909a13880af3af5ad8b957301ca4118ce02278647af08b2eb3f5df79a014', '0x1b62400e9700f58d2c2856cce24642862fdb03bdd12acabb478e4e1c06edbde5', '0x0697ee778c6924d4ab026e2c21de943bc0c944476a9a49dddaeb08e8c18a6eb6', '0x14dff85a3ae911145d25f003d47444de7e8ebb3463a66cc259942e0eed924c3d', '0x12e1333253d8efa3f8e7ee212ab45fe56625e02fc422c700c782f711ee6203e9', '0x2211c9e15bf6e60cc93ba6a6cc80fd8e8031056036adc8f1753fc5bcc54d7818', '0x1b65a8bb72eec52fefeb31bc51922067398e28ec0c9fa860f2da0e939eb48306', '0x25ba8dcd8f7c78fccf751538b17198eee7e60c9a8d895aa5ce2ad958cdb73189', '0x0470eb8e20f078a35cda697d6fc191d2af9440b3a79bc00ec747a20708e35a57', '0x1a9ae1c9bd317826977b9f3aa6b2a4ae19141e19a0887079c0d55921d529e682', '0x08cf1637912a414ac96a4018093e9d0341e1073318c8046ff427c025b9cb736b', '0x29299b596709694c3f91c31018f06ce839c3a296e2892d09a4fc4702293b635e', '0x282470b8898803a16597ebff71f58c8fff2821eb764145132e037c87b3db24e1', '0x2e9ae1a6740c7d076fdfacccd510ff41bc11e68e8f86bcad8dfbcd7c25e3d145', '0x23e80f792c830bdeda58cefc135de42918264833801e9cce635af63e462405c0', '0x1f714748aa615d093916222868eaf76ee3ac5eec11f0f6ee58bc892fe60d52aa', '0x101f4a28ba29ffb7ff8fd748c77c8816e5b430d3fa5cdfa7f23b70631cdb80b6', '0x11ea4a4c2e5edfde17f422f0ab45494a6ceeb3b0f56a7311cffcc2160c628691', '0x27ea4edc3aa6853e6e9e1aac9e84e7a91d1d68a68bd212d9470037c297793b1d', '0x2d3827aedd6bbddf2d2e6a0fb608b9a6563581a35406067eb33564128dd18b3a', '0x07db8f55f3489a2dd09d11cf6a444fcdf7f9d918788ef3d3c97d40bbc4f56ca2', '0x25358d321d99e3135152cdd4453471bfb58ec7f34155f0559352f2e9921f6c6a', '0x2166569b25a6e6ab27d68997ed746e2d29a314d61d5782dd086ad24b940161ef', '0x2f0f0891dd69c43a0971c6dfc509ec70b12311d180efe6b08eff2d290157cf7a', '0x0623c53ece195190a7babb84a2c35f83562c28398463906322bcddf3c8ede27e', '0x16c94995bdba3785e1a19f79cbdb25776ee2f0ed111bb7d65a00f4394071be0e', '0x08d00ca21e826e7240123bf4924a777e52e6c22e3f7ccd7ca3b2b7b59ef2d2a2', '0x2f4d6383392a7ebb15d38d33cf60ff0576a370e80697458d56c1560cede3c339', '0x1d070f1e10bdb4232e365e0cd572c558facf1f883b2c2ae222812d5bdf396adf', '0x2ff3bff6e70c1c3725ce6e47edce849c9a7c6f6c33b26205d994bee81e20d3bc', '0x0bbafe4bd1ca4bfe62009eb59740c97ef9389576bbf60c9656388ea7a9fccedd', '0x05a5552c3316b46f33b2c6cf084e17d35d157b33e51c5ba44b08bd175fa67229', '0x27298066b3247b83f740c5f054dd99a0f132f168bf32e3cb6ecf93f9296c802b', '0x14fc2e19b05f69fbdb97b77aa28b349d2932f9de9fc50072d7b44b277115f78d', '0x0f3ab804b544a733ea14a855ef6ccc0cd84a4794d9dfc1290cba0ef0e7df9fcc', '0x20a7d867036ebf30f6295ea264f8c14ab8b999256ab0a11801e6df6cf4fe7f8d', '0x23025d840a7ea9ff34c200feb3b2dc9c38f18a52f773fe714a5e0382b5d857dd', '0x061cc8cb9b0672fc5627b365f33503255556686256d640337e1b2f38a1a11c41', '0x207fa83c47ac269f2072041665e5b20b279be43bce0402015ee7da3ce58f73b0', '0x23d2242887f52238879c2b7e75c9159d7ea15ccafb33dc48c4a9a8f58d5659f0', '0x2e7374757ce0bdad75d1e39ac7d034d18c355a79f6b198f40067c0830c534c22', '0x305ef5af0b960f859021ab15d699aa072c5b149c4c13351c7ba9a93949cbf430', '0x24581b02f4c5060fd03cb3779ae73a44e14a614332406ad18996955483545e66', '0x222b3b80f0c3e2fe1a7764eddc26e9610d8b656b2810b067bb4b4caaf4067a5b', '0x009cff94c9fca8764f8c77727edd374d66c8f6bccc03a81562e83450e2fcc413', '0x0be82a5bf06d779af21510ea4f451d99a4ad317ce31f5475cf6b9f338534f0cf', '0x25ebc78f1462f9eab6d8203963071bb20fcd083d1bb80cf0af75dc00c04f39a8', '0x07d355d08fc1b13f58c63f1d678e9bb99ab67e759b7648f9a98df80f1b351be2', '0x2f126dd381fa008ab0e9c725f76ec893c354408089f588c159b078eef26853b7', '0x0578fe40a6c8c671bc13190499de4e26f2fea10fd660d9f4da0d66eed9d1abde', '0x113da51b4502b6d10b9105b81395a03715a54d3222f5931927b07c8c5e218b9a', '0x1fc205ae04ca232207b517ee350a52f292953f3b1061c3c6fb6b8166f526baa9', '0x088fee5787543b0e210fbe8c541f2434ddb1b7a3576d59e6a5aa0ed2cea07610', '0x23bc83603f3698e661c7342b768c98a7fd584bc985eef67f5aa9ddfbfbf046bb', '0x1072c16fafa9e7fd914a2c3c22e7a8ca548b63f98884f47be5a108db9eed256f', '0x2f3bd2c3a76b45d3a6d6936ddcac2ccf20ff10460ccac088717d70d031b4f4ff', '0x12e242cd9bb504a60fdc6518ec93cf1c6ac489a8c9453420af127a5fe2aafcb4', '0x2703e25d30d5136c8fed8130bbfc2d9d5fd08b430b04f3a9f2e4bec635e6c8c5', '0x221da43a8f793c6a11fbd119381ed688aa23014ba1e9ddbea4757518c009fcbd', '0x2e1a57546dc388d21e9f2722fd990c4e61530d3360564a0b4b9f5ca074fa60be', '0x0081c699da7540102b76b7ee216e103bff2ad120d90fba14f7d54cb4f62cffbe', '0x0fb405e11ff27cf01e1cdaafe73887a2568cd59b7bd4530ac59bd1aefc1ff9f7', '0x098285abb5c7cf897b6d2a151c49dec808a36b1b888aa163a27ab1c9942ac61b', '0x0f74207a43e649acd1dd5aa9fa867cba1860a9e1681af2ec702f41d51f51cb93', '0x1f1a20a71c8dcf7ed61d9dc26ace6b64d1558acbf006d3d10673fa9a2b4501e1', '0x184bc1424bd82b6da4b48b260be690246e82e7eea571b06c732190af238a192e', '0x1783c75f05d6ef9e37f203f984bb35c47fdd1e2da0ee659fd3604780f68b697b', '0x03565b23911cc4f310783afcf247cebc3471836577249b8f19d84ed8d58430b0', '0x0d4d3bce167173f6bf730686ba64a346685e2a879325e313aedaf2c5a6cdcfc3', '0x27d139bd2ba57fe3c5ad48f67fc42546892bee262c9e7ff139866dc4450511d8', '0x1c9c76eb96b6e2c949f5cdc0aec57d824bf70529732f8a8ddeb66df1d0952e36', '0x0e2b280e23af550c221c78ec8a3e77f9833f9baf684c00087a62964b3402e358', '0x0e4fbe8e16921a68e25913299d1b423a218dfa13d831d02da3da09112de694e5', '0x0a53ddff4e0becbc43d9e13c5c3a0e982fbcdadd9cef069a29dfaa67b49bdd4d', '0x2aec792b9e8e5ce59b204028d2b3548f24be249fc506302c3455f3fcbc1b0632', '0x208aae49cc73dcabbb4d8c6daa525a071a0bcbfe8dc83b326d54a3b28d9823ac', '0x1b21af032b34d6288f0f35e9cf64a181dada19148de28f8c5ea4d99ed8800b33', '0x2f552c24003cff63e5ff18e4bbc437c7a06d81e614ce82625fa42667a22871ba', '0x003d0efe16bf438b32f298243dd139ce37a1911c9a9ba4defba1eeb14d3c2645', '0x266e65ff8f6cfa3e076109f675677ec9de3d903d599d01f2ba2f235a398629b3', '0x0dfdc0d009247489cd8211665b37344fb2e8eaf3d6eb9f1617fad85dc962512f', '0x0c28bf80d4644c49d56827141b9660f604ac85ecadbb5a9893048a5ad58ff447', '0x0715b289efd22277033870344bc6a313229cd925165380feaae071889cc7d102', '0x14bb0f90d1253f63baaa093d99a5359b9ba731643fde09b905f11a1ab9fac09d', '0x0b948493d1ac7d72afa2812b9eb572e775df353f3a06f1581e71f35e2c2a6576', '0x146d5e822b944387838c900df6c829e0dd4adbf4cd82dd8feecf442a2fd2ca26', '0x116c29a53e9cb47b2bca27eba8ba75dd761924770b21bcf66a86ce61165f5a26', '0x16916f30e584556a3ed2b1813f725ec5ab75f0d68b0940b45738fa7d4e0e3456', '0x2971d39c192289766193dff498f7b41842945288718543f53d603e6947bd4f20', '0x1cea8f055deebc3b63d1bfe3dba83be78baf4e8f198b83869605ea2fbe43ca73', '0x25bb972e1d57ec61ea6c9ada4e3cc7575841169eb2bc5fb3ebf469c4057b6fb8', '0x1cc7509ceef4cb452a1956f24a14d52943ff2eeb6a617d47d4b959642f7721ed', '0x2f82cb4db65e3a09b83f13a6bf6c786d6e9d62b5c7dd053774744a35aa566adf', '0x0ae90c48395c85cc0d0059907d4cc9761e6a7eeb4834025a7352cff27675ec7c', '0x24b4ac26355f0bd96f7dbda13c275f382ca8d2967e0bca8c8f33e0fd5e708e4e', '0x2936e39a26242124843b2d0982eb29c577d703f8e8b6fd1b0abfb93c17640373', '0x256bbc4b898089e91d3c2ecff1a3206de5b1ec328baa2745d2c46f96978e0b1c', '0x2006d674816e7a45f6b2a299264cfaa0253bd61d79808f2aa987bb2ab3e725c8', '0x2df007ae3433648a0ba987278988011961efcd8f0d3afc409861c351700fd7d2', '0x24c53c79c7daf545b22350b6fda6be5fdd10be163ab0f73543ce0e628e0b9ccc', '0x136cb810161f7d5d476fd540ee8c81b7af45936d702b97a699d0c266438f6eda', '0x26c9c47157d7f201a449117d71f5081cf2ef0ac1ecd78163ee78a2d08c18de46', '0x04831b919c5aa31d518963a2f54d5bcd44fe890feaea993e0c70ff638b762d7e', '0x18e8b51372c248f33640e95775f0c09bdee3b399fe3625a806ba2f7287ee067b', '0x1dc26499874691a2ebd8e0f4c580951db3914ad438baf94e821068cca3391a80', '0x1befd02bc90aa07a6dfa91734037a34287ed764e726a3c4e6a6673f6d991d0d3', '0x0e1d119608358ce6694a46e33ed0e553a8e7ec34481d81757f3a1772439f6bd5', '0x07fe40afaad9daa2479cd2b55e5c030b531da85052d61dffcfd38c40e2eb1731', '0x2f7fad71c7fa60bd31b6793fb826cc32d816c7632501ff7e7349f19032a92fe5', '0x147233ecab127a73bcf0651529a70638d70c830e7b7fde84496f88fd64741c1d', '0x12a3fdcf328fc96b9ce0d21687822b1a4734d56b36cce06d9546f34d7e55b839', '0x29a0357bfc3127b96e1ec97335ea400dfd7ac17018f5603a46d7f0a029ab86d9', '0x1b19720892d1284be6fb532fcc291ff9a877805dc6d04bfbdab3229292451291', '0x2eed9e3edc995eeba02c1da148e1343f0c7cf3b4c03ab7d0173a451970f9d3a6', '0x2cd998ca94b5861a2d6fbb9684a445dc9afc2dee3c0479524969064e6690346d', '0x16ba40fab8454b3c5da626dd5b0afb6b8fc181e3bb887eeb1efd2e1c89b32984', '0x2b1fd784e9ab3f4815be7113f768204b241aead710b4a33a4dfbde105f50bbb8', '0x2c4da74e0c158839f5ea2c2279f1b0b738cebb64a4fdef96b23fef1498af5092', '0x12d83e6d5817aeccc8608ed70b078b8a4519935c3457fdd2ce1afa36ad9c8bdf', '0x07dc39c4fe8f1d58c4743c4adee4e9c911b99c099835c4c19a23b1c373965b61', '0x1e79a6b21d4f64fe2cda01fe5ffa41f89a7d83b8753ff3fe35693749a50a5d33', '0x0466b6bfc67df7ca4310ab75a50ca91d6b50c1d4f51c6321ebcaf57d702e2b81', '0x26dd0b402d8a15f148f455783adb8e6bfefa046cefbfd55ee374183c357b46bf', '0x12c1219c80a06a0685229f16ed0e331affce882d4c88a775e54460aa81578f53', '0x1fe5ab9ab75635b08fdc3fbe68fbb0d647346e45c7fd002e87f7fb8223d3c77a', '0x0661aedcfdaaecb70636cb5130d364d6cb081e2a12551ef797431a0e918669d7', '0x20378920772f4765d2839c3922edbcd8cd983e029bd8e9d2633573602d8cc751', '0x0472dbb95aa61838771cc65c4f1ce4711996e50f067f3e2aec9173d9439ad50e', '0x2257381a4391f03cd43e09c7b17ca40cf55e9edcce806858dc12daf68e90e8a7', '0x26c15d73668df099b39eca625230dd8338588a11e1b2e7bde783ef01e0f1a495', '0x2e7f6d2bb6640cd8e769e9c151a3d8fdf1079e53a3f40e11cd9d369e3c92a2f6', '0x2af8b683e11701dc2b8b296f2817bcec8e90ff62e0d4b461b2ed62f20d584bfd', '0x1ca151f9a56dc24c9cd427ae1b9cc1fa2e00e17d29c4809af24881da5bc7f235', '0x2bdd8b4d38ff58622947e582d2e94dc39cf92b3fab4298e3df804567e5f948c0', '0x1879e59c9867ca4a28a48f5ef5daaf703741d9c069608d3cd8b87b8492e64f0b', '0x2eb268e0f932ae98ba988c0413eaaa2bd8879d191a7ee7ee898b9db1c1bec0b1', '0x1ea0bcd296059cb60d6be82e2b72ef0ca04a6b840a6e57e07c5d8d06abdb9317', '0x248e58ec849bc3c929b2a0879fbec7ec3a0a358d854e16fe6cdf56135fbc9ed7', '0x2501293b11ec903ff026b5e3e73261ea9a88649d43aa30919a88918a5b1c3a1a', '0x0af49521690a7ebe8ae790406e847f856397bc2f6db5a46aca60a6d6d14de0d9', '0x147b043a0e15fda095527ebbff6117c310e1c3356c72ce3c6bb0c8e6e0e1d4a2', '0x1f1279086a8006c0478a9af3e64f5b327c46d8cffa1ae936218753d19eaf5879', '0x303307513b8a203d2401bc8985e0ebe1697fce0e383995534bd525a4c57f39c5', '0x1412c907f7c7b5b9662e80a1df520a50e0d06a99020016cea69ccd942a34a5f5', '0x11fba14b1e7132cbc27dd1769610e0ca7f790717a2042f281251663f26609da8', '0x13f56b74aec39e3203f1a8d354b46212c02f0cfe5ff300c7f95c1ea9a210a1ef', '0x27624d870beed6d61ac0a46cfbf1aafaf5eaf581f822ff0bdb296b8a92671149', '0x124aa6e77579e3633b5e459734f1dc9000ac0194e3db25313cc49e33359b3158', '0x0db1a13b2693bc5341797057ab13f9a38f4b1a590cf7a0cc99fe4ada2dc08935', '0x00d372c1a1f7f8d5a91adf4be634731f623efc1b13a01aae0e3cba793bf57deb', '0x22a1227b1167c973c9d2426af5facd7a6a2d86daf95e5158168e434987a7b8fd', '0x26a35c59721f35571a1a4ffbd873405d7c92748c873bf05940e10643e8d55491', '0x1660ca3a3dafa4af39bb255cc5d49de22ecbf2f911faafefde9b502dafff7182', '0x191a028ed404fc7a9820cb18d1c029be268a69c70326c9a8f8f80b42a20b0501', '0x22337ac2d2924078418cffb3f8791f6d42c756c17587d3a2a31961091c0bcd6d', '0x277fbc02f44c54b831bff5c5d78ed5849f426451eb4b95f55c575a0544dce11e', '0x0ddf28192b0ff4bc0d09dfd615d2c4e747cd2431c9055deb5991fccbc0796cfd', '0x15097fa25290f122ff618e711a2772126e81c0fe4aeb811396c00293763b7557', '0x010e5f8381855da28f1c13cb6e9d60b57c1f4fa6c741903b4a20687ea41ccb1c', '0x192c5ecb15c8ce43d837fd6ddfa9588493cc1c6aaadef52f8f543d87dda31697', '0x0ac34d6a37f3c15011dc06a9f6b1d53919bf656fdab2644a76178da21149a797', '0x11ab3249e90c44538650db2845e65bb16053d150cb637f234f50717d30e090f6', '0x190e9e5a46c53c645a3635c55773ea27e3c3d8773abb003c64fac2712dc44486', '0x07318902d0695ab97011c64a1a50c8fd50367e64fc6becbaa5361ea8b2c23d62', '0x0c26eacfdfff6f3250e7529d7f7f95c0bfde3d32854d4a8a5dc60427faaff3ec', '0x0f6ba93cf92811def10d255ba66a984ed236767a6c28eb90305a61483728b70e', '0x0d01fb02589eeb6a965bd23b0ed40fc35fe415ccc7db31fdde6143c638a107b0', '0x2f69c2d72d73d0aeab3c62b9cf3dcaf23cb79f1ff9d3b69a12e94b0071f9963a', '0x008a003844f55e847a14bdbfe15bfb64343da7dec86705c548c7581f7d842e57', '0x2ec4edc17ee6b70283013f157fdf44b66eb71fafc2141c749b3eca9367a28f88', '0x0756976a544f96f5466b1f8156b41b57eb7383057c12dcb8093d7186f67d6fed', '0x06cbce4cb67bf99a0c4dcfd76345472d80b12b33a42118de22f9e841a855eb12', '0x2d494b0ffce304e8ec458fd7c9fc7d98294218029911bdd44503c60d600e8c9f', '0x2963289b2900e3d796180bc10cfa42da5a4ec6f2de5e1db9c5c2355da616306c', '0x03a19f25164e563974513172cc8ccdd44a620329469fd2ff35d3083b4c8c0ef5', '0x2aadbe617f1c1ccecff85b723088099f8d652bae7dea33127904ddf6e6f39c2a', '0x26b8cbd668e17c62c199956c227e50eeeed7ebd0ff447d86147f36d2260f4515', '0x198ce4100f57d0e0445626ad4accb1cf1f6f5aeca2eebe946a22aca364a4002b', '0x0d8d03dd4372705119382279b742e0154fff41a4e3f6e6d0d91692df81c7936c', '0x27f48c4c6047076747df44521a4b32e6f2b808a1cddaeecfdb5c40d5e2dacd69', '0x27211ec47aadda3f504c1e4c0b271f0e2e3a0ab142531436e56da50e8915f800', '0x2b942fd614e12643f0a500b5e26220c1f60662d72a9bdfde45331d00e7ba7f3b']

MDS_matrix = [['0x17d5db88fcb4920262f3aa0ca8731049ff31c49478ee3ac53ce84f90000bb06c', '0x16b8606ba13fc4d08b79d482bc790e565ec65be93f17146fc38edc9f4fd3a565', '0x02500956b3bc88a604d7d16b16ec3b99e1aa909d561e0e0c37359a5b0304e3e5', '0x0251f9fb1bd8e02399a9a8e0408aae5e792825e752becc701270c83e9081ccaa', '0x1a91e8961d01aaca1fb0fbed0f71779bc706a0f602defac98eba95f2ea7a58dc'],['0x17137b333e243dd40f7bbf38a372002d3473c64e3d6e72cbcf648873bfcdd623', '0x258f34451b4924dcece0d441e62e2bbb030620bf46d8623870ad18539db8027d', '0x08b396d7bbc7adcf4f2449301aa759c242ffdfc2cf4768ce9a7df8c4082ea8f3', '0x08b5fa04d05d984836fe2fe7babc957127517362ee53b90599c7e4cb1790e68a', '0x137242f9cb57ad59c5f912397a4fc154f5338609bc82b42dae376065ffedc20d'],['0x052cea14b04697c0366da0665ca413b3a6850407631db1726fe59f9088152732', '0x169d34fc62c9f3f0789e833727eba8df8f32d4fe99dc2f7d96d4c102389f5f85', '0x0a7fc0e6276f1e8810047b58b284ff5c1958e7e00d5efa27f322ae9762bf477e', '0x238fc93c33935b8634b6d1cf25690a41fb0f7446730cfc97f33b562f96a1eec7', '0x182580bb50bfa148cc8a7b4ae4ffb149f30799f0ec433c858266adb4ce401d05'],['0x21cc7605fecdaad4a6919d4cac169e0ddfdf383c8e33ab1824da973340dd2ebb', '0x1dd7efe361156afa0d1685c9b9fc2f2423a53b05954d2ee2509fb8900b7bc4a8', '0x30216623ca0ba2ade13d2e6a9ff4157e2053e923e412f7b5e64652ab9c67f061', '0x07c899d5e174b2c53ced20c42c412e3cf64459ad20f5de46875084cd096e9338', '0x2c477baabda9ebc545c644d8c00af85ec57447cdc4aa6befc081463efd5d27b8'],['0x0315148ebb0357123890066b648b8aeca1bc489bfd70d6c27f7cd4a572c4072d', '0x1f7c728986b7ddc251a0061ea288fb0d5a41f1b7cc6c4eb68749d03eb5edc043', '0x030ef19644377bf0155719cbf4f5d0a355fa62e51599c7a84217a55c636f2ac4', '0x2cb029eafb2017d1b2b8cd7ffcd45ee7381071e2c1d4d7e268229803ba754880', '0x03871b07036eed200b325b9169bd1c307464b6b83a3b2818c46890095e7c6b25']]

MDS_matrix_field = matrix(F, t, t)
for i in range(0, t):
    for j in range(0, t):
        MDS_matrix_field[i, j] = F(int(MDS_matrix[i][j], 16))
round_constants_field = []
for i in range(0, (R_F + R_P) * t):
    round_constants_field.append(F(int(round_constants[i], 16)))

#MDS_matrix_field = MDS_matrix_field.transpose() # QUICK FIX TO CHANGE MATRIX MUL ORDER (BOTH M AND M^T ARE SECURE HERE!)

def print_words_to_hex(words):
    hex_length = int(ceil(float(n) / 4)) + 2 # +2 for "0x"
    print(["{0:#0{1}x}".format(int(entry), hex_length) for entry in words])

def print_concat_words_to_large(words):
    hex_length = int(ceil(float(n) / 4))
    nums = ["{0:0{1}x}".format(int(entry), hex_length) for entry in words]
    final_string = "0x" + ''.join(nums)
    print(final_string)

def perm(input_words):

    R_f = int(R_F / 2)

    round_constants_counter = 0

    state_words = list(input_words)

    # First full rounds
    for r in range(0, R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(MDS_matrix_field * vector(state_words))

    # Middle partial rounds
    for r in range(0, R_P):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        state_words[0] = (state_words[0])^5
        state_words = list(MDS_matrix_field * vector(state_words))

    # Last full rounds
    for r in range(0, R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(MDS_matrix_field * vector(state_words))
    
    return state_words

input_words = []
for i in range(0, t):
    input_words.append(F(i))

output_words = perm(input_words)

print("Input:")
print_words_to_hex(input_words)
print("Output:")
print_words_to_hex(output_words)

print("Input (concat):")
print_concat_words_to_large(input_words)
print("Output (concat):")
print_concat_words_to_large(output_words)
